<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Relat√≥rio Preditivo Mec√¢nico</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Cabe√ßalho -->
        <header class="report-header">
            <div class="logo-section">
                <div class="logo-container" id="logoContainer">
                    <img id="logoImage" src="" alt="Logo" style="display: none;">
                    <div class="logo-placeholder" id="logoPlaceholder">
                        <span>LOGO</span>
                    </div>
                </div>
                <input type="file" id="logoUpload" accept="image/*" style="display: none;" onchange="handleLogoUpload(event)">
                <button onclick="document.getElementById('logoUpload').click()" class="btn-upload-small">
                    üì§ Upload Logo
                </button>
            </div>
            <div class="title-section">
                <h1>RELAT√ìRIO PREDITIVO MEC√ÇNICA</h1>
                <h2>AN√ÅLISE DE VIBRA√á√ÉO</h2>
            </div>
            <div class="report-info">
                <div class="report-number">
                    <label>N¬∫:</label>
                    <input type="text" id="reportNumber" placeholder="Ex: 25/252">
                </div>
                <div class="alarm-level">
                    <label>N√≠vel de Alarme Atual:</label>
                    <select id="alarmLevel" onchange="updateAlarmColor()">
                        <option value="normal">NORMAL</option>
                        <option value="alerta">ALERTA</option>
                        <option value="critico">CR√çTICO</option>
                    </select>
                    <div id="alarmIndicator" class="alarm-indicator normal"></div>
                </div>
            </div>
        </header>

        <!-- Informa√ß√µes do Equipamento -->
        <section class="equipment-info">
            <div class="info-grid">
                <div class="info-row">
                    <div class="info-field">
                        <label>Data:</label>
                        <input type="date" id="reportDate">
                    </div>
                    <div class="info-field">
                        <label>Inspetor:</label>
                        <input type="text" id="inspector" placeholder="Nome do Inspetor">
                    </div>
                    <div class="info-field">
                        <label>N√∫mero do TAG:</label>
                        <input type="text" id="tagNumber" placeholder="Ex: 4400255387">
                    </div>
                    <div class="info-field">
                        <label>Ordem:</label>
                        <input type="text" id="orderNumber" placeholder="N√∫mero da Ordem">
                    </div>
                </div>
                <div class="info-row">
                    <div class="info-field">
                        <label>Equipamento:</label>
                        <input type="text" id="equipment" placeholder="Nome do Equipamento">
                    </div>
                    <div class="info-field">
                        <label>Componente:</label>
                        <input type="text" id="component" placeholder="Componente">
                    </div>
                    <div class="info-field">
                        <label>TAG:</label>
                        <input type="text" id="tag" placeholder="TAG">
                    </div>
                    <div class="info-field">
                        <label>Defeitos:</label>
                        <input type="text" id="defects" placeholder="Descri√ß√£o dos Defeitos">
                    </div>
                </div>
            </div>
        </section>

        <!-- √öltimas Medi√ß√µes -->
        <section class="measurements">
            <h3>√öltimas Medi√ß√µes</h3>
            <table class="measurements-table">
                <thead>
                    <tr>
                        <th>Data</th>
                        <th>Valor (mm/s)</th>
                        <th>Alarme</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody id="measurementsTable">
                    <!-- Linhas ser√£o adicionadas dinamicamente -->
                </tbody>
            </table>
            <button onclick="addMeasurement()" class="btn-add">+ Adicionar Medi√ß√£o</button>
        </section>

        <!-- T√©cnica Preditiva Integrada -->
        <section class="predictive-technique">
            <h3>T√©cnica Preditiva Integrada</h3>
            <div class="charts-container">
                <div class="chart-box">
                    <canvas id="vibrationChart"></canvas>
                    <div class="chart-controls">
                        <button onclick="generateChart('vibration')" class="btn-chart">Gerar Gr√°fico de Vibra√ß√£o</button>
                    </div>
                </div>
                <div class="chart-box">
                    <canvas id="spectrumChart"></canvas>
                    <div class="chart-controls">
                        <button onclick="generateChart('spectrum')" class="btn-chart">Gerar Espectro</button>
                    </div>
                </div>
            </div>
            
            <!-- Upload de Imagens Adicionais -->
            <div class="image-upload-section">
                <h4>Imagens do Equipamento</h4>
                <input type="file" id="equipmentImages" accept="image/*" multiple style="display: none;" onchange="handleEquipmentImages(event)">
                <button onclick="document.getElementById('equipmentImages').click()" class="btn-upload">
                    üì∑ Adicionar Imagens
                </button>
                <div id="imagePreviewContainer" class="image-preview-container">
                    <!-- Imagens aparecer√£o aqui -->
                </div>
            </div>
        </section>

        <!-- Recomenda√ß√µes -->
        <section class="recommendations">
            <h3>Recomenda√ß√µes</h3>
            <div class="recommendation-box" id="autoRecommendations">
                <!-- Recomenda√ß√µes autom√°ticas aparecer√£o aqui -->
            </div>
            <h4>A√ß√µes Personalizadas:</h4>
            <textarea id="customRecommendations" placeholder="Digite recomenda√ß√µes adicionais aqui..."></textarea>
        </section>

        <!-- Refer√™ncias de Alarmes -->
        <section class="alarm-references">
            <h3>Refer√™ncias Alarmes</h3>
            <table class="alarm-table">
                <thead>
                    <tr>
                        <th>Ponto</th>
                        <th>Normal (mm/s)</th>
                        <th>Alerta (mm/s)</th>
                        <th>Alto Risco (mm/s)</th>
                    </tr>
                </thead>
                <tbody id="alarmReferencesTable">
                    <!-- Linhas ser√£o adicionadas dinamicamente -->
                </tbody>
            </table>
            <button onclick="addAlarmReference()" class="btn-add">+ Adicionar Refer√™ncia</button>
        </section>

        <!-- Bot√µes de A√ß√£o -->
        <div class="action-buttons">
            <button onclick="generatePDF()" class="btn-generate">üìÑ Gerar Relat√≥rio PDF</button>
            <button onclick="saveData()" class="btn-save">üíæ Salvar Dados</button>
            <button onclick="loadData()" class="btn-load">üìÅ Carregar Dados</button>
            <button onclick="clearForm()" class="btn-clear">üóëÔ∏è Limpar Formul√°rio</button>
        </div>
    </div>

    <!-- Loading overlay para gera√ß√£o de PDF -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none;">
        <div class="loading-content">
            <div class="spinner"></div>
            <p>Gerando PDF... Por favor, aguarde.</p>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
